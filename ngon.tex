\documentclass[11pt, oneside]{article}   	% use "amsart" instead of "article" for AMSLaTeX format
\usepackage{geometry}                		% See geometry.pdf to learn the layout options. There are lots.
\geometry{letterpaper}                   		% ... or a4paper or a5paper or ... 
%\geometry{landscape}                		% Activate for for rotated page geometry
%\usepackage[parfill]{parskip}    		% Activate to begin paragraphs with an empty line rather than an indent
\usepackage{graphicx}				% Use pdf, png, jpg, or eps§ with pdflatex; use eps in DVI mode
								% TeX will automatically convert eps --> pdf in pdflatex		
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage [autostyle, english = american]{csquotes}

\newtheorem{definition}{Definition}[section]
\newtheorem{theorem}{Theorem}[section]
\newtheorem{conjecture}{Conjecture}[section]
\newtheorem{lemma}{Lemma}[section]
\newtheorem{conj}{Conjecture}[section]
\newtheorem{corollary}{Corollary}[section]
\newtheorem{remark}{Remark}[section]
\newtheorem{proposition}{Proposition}[section]
\newtheorem{conditions}{Conditions}[section]

%\newcommand{\defv}[1]{\textbf{\textit{#1}}}


\title{The local optimality of the double lattice packing}
\author{Yoav Kallus and W\"oden Kusner}
%\date{}							% Activate to display a given date or no date

\begin{document}
\bibliographystyle{plain}
%\maketitle
%\abstract
%This paper shows that the dense double lattice construction of Kuperberg and Kuperberg is locally optimal for polygons in the full space of packings.


\section{Introduction}
%How to view/present this.  Experimental, algorithmic or fully rigorous? Seems that full rigor is hard as it depends on certificates that are non-trivial to verify for various reasons.  
%There is an algorithm of constructing the densest double lattice packing of an arbitrary convex body in the plane.  In this paper, we extend the optimality result to a neighborhood in the space of packings.
%The story: Some of the motivation was curiosity... some existing results and explorations that could be meshed together...

This paper began as an investigation of the optimality of the double lattice packing for pentagons and heptagons.  In \cite{kuperberg1990double}, G.\ and W.\ Kuperberg describe a double lattice packing of congruent planar convex bodies with maximal density that can be constructed algorithmically\marginpar{YK: what do you mean here by ``algorithmically''? How is a nonpolygon represented computationally? \\ WK: perhaps "procedurally" for "nice enough" bodies?  }\footnote{For the case of polygons, this turns out to be linear in the number of vertices  \cite{Mount1991}.}. As an example, they construct the densest double lattice packing for regular pentagons and show that it has a density of $(5-\sqrt{5})/3 = 0.92131\dots$ which is the current record and possibly the best \textit{general} packing of the plane by regular pentagons.

In the early part of the 2000s, there has been a significant push both theoretically and computationally to answer some of the most naive yet perplexing questions in packing \footnote{for a background on packing problems, see \cite{brass2005research} \cite{conway1999recent}\cite{groemer1963existenzsatze}.
} Along with the proof and formal verification of the Kepler conjecture \cite{hales2015formal}, a number of other results have proved to be both illuminating and frustrating (Cohn-Elkies LP bounds, Lower bounds...).  For packings by congruent anisotropic bodies, sharp results are limited mostly to the plane, where the best packings of all 0-symmetric bodies are achieved by lattices \cite{fejes1950some}, and a series of sparce results in higher dimensions. 

For non-centrally symmetric bodies, the problem of finding the best packing of regular pentagons serves as a toy model for problems
like the best packing of regular tetrahedra. However, it is still not a tractable one. Explicit upper bounds for the packing of regular
tetrahedra and octahedra are better than the trivial unity upper bound by minuscule margins \cite{gravel2011upper}. A semidefinite
programming approach has been suggested by Mario et al.\ \cite{mario2013computing}. Though the SDP method has not yet yielded a nontrivial
upper bound for packing of tetrahedra, it has been used to obtain an upper bound of $0.98103$ on the density of regular pentagon
packings. There remains a large gap between the highest density achieved for pentagon packings and this upper bound.

Even in the plane, it is an open question to find the global pessimal convex body, that is the shape that has the lowest maximum packing density.  In the class of 0-symmetric bodies, it is Reinhardt \cite{ reinhardt1933dichteste} who conjectured that a smoothed octagon is the minimizer.  In the class of general convex bodies, it is conjectured to be the regular heptagon.  However, even though the conjectured maximum packing density of the regular heptagon is the maximal density double lattice, it has also resisted proofs its global optimality.

The regular pentagon and heptagons are cases of special interest, and we initially sought out to investigate whether their optimal double-lattice packing can be shown
to be also optimal among a broader class of packings. We were able to show that these packings are optimal at least in some neighborhood in the space of all packings.
Furthermore, we discovered that our method can be generalized to all convex polygons. We demonstrate that, while double lattices are in general not globally
optimal, they are always at least locally optimal.

\begin{theorem}
Given a convex planar polygon, there is a double lattice packing that is locally optimal.  Modulo vertex condition... \end{theorem}

In that light, we must establish the correct notion of neighborhood.  This neighborhood should be broader than simply the Hausdorff distance between two packings.   To that end, we recall a topology on the space of sequences ambient isometries 
 
We recast the relevant portions of \cite{kuperberg1990double}.

We prove a stability result for non-linear programming problems.

We characterize the pentagon.

 We give a local parametrization of the neighborhood of the double lattice in the space of packings and give a characterization of the a correction function and show that the optimality of the local configuration problem implies the global density result.


\section{Theoretical Considerations}
\subsection{Local Stability}

\begin{definition}
    Let $\Xi$ be a set of isometries. Its \textit{mean volume} is the limit
    \begin{equation}
	d(\Xi)=\lim_{r\to\infty} \frac{\mathrm{vol} B(0,r)}{|\{\xi\in\Xi : \xi(0)\in B(0,r)\}|}\text.
    \end{equation}
    The upper and lower mean volumes are the corresponding limits superior and inferior.
    We say $\Xi$ is a $(r,R)$-set if the point set $\{\xi(0):\xi\in\Xi\}$ has a packing
    radius $r$ at least $r$ and a covering radius at most $R$.
\end{definition}

We will look at packings of congruent copies of a convex body $K$. That is, every
element of the packing is given by $\xi(K)$, where $\xi$ is an isometry of Euclidean
space. It will be convenient to assume that the reference body $K$ is situated so that
its interior contains the origin.

\begin{definition}
    Let $K$ be a compact set with interior. We say that $\Xi$ is \textit{admissible} for $K$ if
    the interiors of $\xi(K)$ and $\xi'(K)$ are disjoint for any two distinct isometries $\xi,\xi'\in\Xi$.
    We say furthermore that $\Xi$ is \textit{saturated} if there is no $\xi$ such that $\Xi\cup\{\xi\}$
    is again admissible.
\end{definition}

There are $r(K)$ and $R(K)$ such that when $\Xi$ is admissible and saturated, then $\Xi$ is
a $(r(K),R(K))$-set.

\begin{definition}
    Given two $(r',R')$-sets $\Xi$ and $\Xi'$ of isometries, we define the premetric 
    \begin{equation}
	\begin{aligned}
	    \delta_R(\Xi,\Xi') = \inf_\text{enum.} \sup \{&||\xi_i^{-1}\xi_j-\xi_i'^{-1}\xi_j'||:\\ & i,j \text{ such that } ||\xi_i(0)-\xi_j(0)||<2R \text{ or } ||\xi_i'(0)-\xi_j'(0)||<2R\}\text.
	\end{aligned}
    \end{equation}
    The infimum is over all enumerations $\mathbb{N}\to\Xi$ and $\mathbb{N}\to\Xi'$.
\end{definition}

When $R>R'$, $\delta_R(\Xi,\Xi')=0$ if and only if $\xi_i = \phi \xi_i'$ for some $\phi\in E(n)$ and some
enumerations. Consider a body $K$. When $R>R(K)$, $\delta_R(\Xi,\Xi')$ is a metric on the space of admissible
$(r,R)$-sets up to overall isometry, which includes the saturated sets as a subset.

\begin{definition}
    We say an admissible and saturated set $\Xi$ is \textit{strongly extreme} for $K$ if it minimizes the mean volume among admissible elements in a neighborhood of $\Xi$.
\end{definition}

Note that the above definition is independent of $R$.

We note that there are packings that might be intuitively thought of as not locally optimal, but
which are strongly extreme under our definition. One example is constructed by decorating a cylinder
with a screw on its bottom base and a screw hole boring into its top base. Consider the packing
where each cylinder is screwed into a cylinder below it, in such a way that the two cylinders
are related to each other by a translation, and the screw is not completely screwed in. This
creates a column of cylinders, and we arrange copies of this column in a triangular grid. Intuitively,
since the screw is not completely screwed in, the density of the packing can be improved by
screwing it in further. Since the interlayer spacing is related to the relative rotation between
cylinders on the two layers, even an arbitrarily small consistent decrease in interlayer spacing
will cause some layers to be rotated by at least some constant angle. Such a motion is not continuous
in the topology we defined. Therefore, it is worth noting what local improvements to the 
density our results of strong extremality rule out and which are not ruled out.

However, our notion of strong extremality is stronger than previously introduced
notions of local optimality local optimality of packings. The notions of an \textit{extreme}
lattice packing and a \textit{periodic-extreme} periodic packing apply only to special
classes of packings. We show that strong extremality, which applies more generally,
implies extremality and periodic-extremality in these special classes.

\begin{theorem}
    If a lattice $\Lambda$ is strongly extreme for $K$, then $\Lambda$ is extreme for $K$ \cite{martinet2003perfect}.
\end{theorem}

\begin{theorem}
    If a periodic set $\Xi = \{ T_\mathbf{l}\xi_i : \mathbf{l}\in\Lambda, i=1,\dots,N\}$ is strongly extreme,
    then it is periodic extreme for $K$ \cite{schurmann2013strict}.
\end{theorem}

We now derive a general method for proving strong extremality which we will use in the following sections.

\begin{definition}
    Let $\Xi$ be a countable set of isometries and fix an enumeration $\Xi = \{\xi_i: i\in\mathbb{N}\}$. 
    Let $\mathcal P$ be a polyhedral complex whose underlying space is $\mathbb{R}^n$.
    For every face $F$ of $\mathcal P$, let $I_F = \{i : \xi_i(0)\in F\}$. We say $\mathcal P$ is a \textit{honeycomb} of $\Xi$ if
    each $n$-face (cell) $P$ is the convex hull of $\{\xi_i(0):i\in I_P\}$.
\end{definition}

\begin{theorem}
    Let $\Xi$ be admissible for $K$ and let $\mathcal P$ be a honeycomb of $\Xi$. For every cell $P$,
    consider the optimization problem of minimizing $f_P(\Xi_P)=\mathrm{vol}\,\mathrm{conv}_{i\in I_P}\xi'_i(0)$ over 
    the assignment of isometries $\xi'_i$, $i\in I_P$, such that this finite set is admissible.
    If $\xi'_i=\xi_i$, $i\in I_P$, is a local minimum for each cell $P$, then $\Xi$ is strongly extreme.
\end{theorem}

\begin{theorem}
    Let $g_F(\Xi_F)$ be a real-valued function over $\Xi_F=(\xi'_i)_{i\in I_F}$ for each oriented $(n-1)$-faces (ridge) of $\mathcal P$, such
    that $g_F(\Xi_F)=-g_{-F}(\Xi_F)$, where $-F$ is the orientation-reversed version of $F$. If we replace $f_P(\Xi_P)$ in the previous
    theorem with $f_P'(\Xi_P) = f_P(\Xi_P) + \sum_{F\in\partial P} g_F(\Xi_F)$, then again, if $\xi'_i=\xi_i$, $i\in I_P$, is a local minimum for each
    cell $P$, then $\Xi$ is strongly extreme.
\end{theorem}


\subsection{Double lattices}

\begin{definition}
    A chord of a convex body $K$ is a line segment whose endpoints lie on the boundary of $K$.
    A chord is an affine diameter if there is no longer chord parallel to it.
\end{definition}

\begin{definition}
    An inscribed parallelogram is a half-length parallelogram in the direction $\theta$ if
    one pair of edges is parallel with the line through the origin at an angle $\theta$ above
    the $x$-axis and their length is half the length of an affine diameter parallel to them.
\end{definition}

Note that any two half-length parallelograms in the direction $\theta$ have equal
area, and we can define that area as a function $A(\theta)$ of the direction.

\begin{definition}
    A cocompact discrete subgroup of the Euclidean group consisting of translations
    and point reflections is a \text{double lattice} if it includes at least one
    point reflection.
\end{definition}

A double lattice is generated by a lattice and a point reflection, or alternatively
by three point reflections.

\begin{theorem}[Kuperberg and Kuperberg]\label{thmkk}%strict convexity is not necessary (see Mount)
    For a convex $K$, an admissible double lattice of smallest mean area has
    mean area $4\min_\theta A(\theta)$ and is generated by reflection about
    the vertices of a half-length parallelogram.
\end{theorem}

%By a sequence of approximations, this gives that for convex bodies $K$ that are not strictly convex, there
%exists a double lattice packing of maximal density that generated a minimum area extensive parallelogram in $K$.

Note that Kuperberg and Kuperberg make use of extensive parallelograms, inscribed parallelograms with edge length greater than half the affine diameter in their edge directions but make use of half-length parallelograms. Mount gives an explicit proof that it suffices to consider only the half-length parallelograms associated with affine diameters as a function of $\theta.$

For our purposes, it is illustrative to consider the algorithm used find the half-length parallelogram of minimal area not only as a method of finding the best double lattice packing, but also as a way to explore the configuration space of double lattices. More specifically, the behavior of the affine diameter is fairly well behaved but non-trivial as $\theta$ increases while the behavior of the vertices of the half parallelogram are described by an {\it interspersing property}; they are non-decreasing functions $[0,2\pi)\rightarrow [0,2\pi).$  %they are a non-decreasing function, they never back track....

We begin with a simple proposition:
\begin{proposition}
there is an affine diameter of a convex polygon K in every direction that meets a vertex.
\end{proposition}

This is a consequence of the convexity K, for if a chord does not meet a vertex, it either lies within an edge or it meets two edges.  If it lies within an edge, it is not an affine diameter.  If it meets two edges, it is possible increase its length while parallel translating it in a non-decreasing direction of the cone defined by the two edges until it meets a vertex. 
%picture

From this, it is possible to determine an initial affine diameter in a particular direction.  Furthermore, this is done by geometrically satisfying procedure of extending a set of parallel rays in a from all vertices into the interior of K and selecting the longest.  However, it does not give 




%critical angles



%\begin{remark}
%Furthermore,  IMVT should say that ever point is met by an affine diameter as well, so every vertex is met by one.? Combining these satisfies the intuition that one may 
%\end{remark}



%continuous sweeping vs finding the minimum area intermediate configuration...
%can introduce the notion of stability here

%Having found the optimal configuration, it is clear that the condition of being a strict minimal configuration and the  




The densest double lattice packing of a convex polygon $K$ can be constructed in time proportional to the number of vertices by an algorithm of Mount \cite{Mount1991}. The goal of this paper is to show that this configuration is not only a local maximum
of density among double lattices, but is in fact a local maximum in a broader sense, strong extremality.

\subsection{General setup}

To achieve this goal, we start by describing a honeycomb associated with the double lattice. Let $K$ be a
convex polygon and let $\mathbf p_2\mathbf p_3\mathbf p _5\mathbf p_6$ be a half-length parallelogram,
such that $\mathbf p_3\mathbf p_2$ and $\mathbf p_5\mathbf p_6$ are half the length of and parallel to
the affine diameter $\mathbf p_4\mathbf p_1$. The double lattice generated by reflections about the
vertices of the parallelogram is $\Xi$ and the subgroup of translations is the lattice $\Lambda$.
Let $P=0 I_{\mathbf p_2}(0) I_{\mathbf p_6} (\mathbf p_1-\mathbf p_4)$, then $\{\xi(P):\xi\in\Xi\}$
are the cells of polyhedral complex which is a honeycomb for $\Xi$. Note that the optimization problem
of minimizing $f_{\xi(P)}$ over $\xi'_i$, $i\in I_{\xi(P)}$, is mathematically equivalent for every $\xi\in\Xi$.
Therefore, to show that Theorem X applies, it suffices to show that $\xi'_i=\xi_i$, $i\in I_P$, is a
local optimum over admissible assignments of $\xi'_i$, $i\in I_P$.

For every convex body $K$ and double lattice $\Xi$ we now have a concrete optimization problem
to solve: we wish to minimize the area of the quadrilateral $\xi'_0(0)\xi'_6(0)\xi'_1(0)\xi'_2(0)$
subject to the constraints that $\xi'_i(K)$ and $\xi'_j(K)$ do not overlap. Since the objective
and the constraints are invariant under common isometry, we may fix $\xi'_i=\xi_i$ for
one $i$. We parametrize
$\xi_i' = T_{\mathbf{r}_i}\xi_i R_{\theta_i}$, where $R_\theta$ is a rotation
by $\theta$ about the origin, and $T_{(x,y)}$ is a translation
by $\mathbf{r}_i$. Since we are only
interested in certifying that the initial configuration is a local minimum, we can replace
the constraints with ones that are equivalent in the neighborhood.

\begin{lemma}\label{lemma:edgedg}
    Let $K$ and $K'$ be two polygons that intersect at a segment. The endpoints of the segments
    are $\mathbf{x}$ a vertex of $K$ and $\mathbf{y}$ a vertex of $K'$. Let $\mathbf{y}\mathbf{y}'$
    and $\mathbf{x}\mathbf{x}'$ be the edges of $K$ and $K'$ containing the intersection.
    Let $\mathbf{x}'\mathbf{y}\mathbf{x}\mathbf{y}'$ be oriented counterclockwise
    from the point of view of the interior of $K$ (otherwise switch $K$ and $K'$).
    There is some $\epsilon>0$ such that whenever $||\xi||,||\xi'||<\epsilon$,
    then $\xi(K)$ and $\xi'(K')$ have disjoint interiors if and only if
    $\alpha(\xi(\mathbf{x})\xi(\mathbf{x}')\xi'(\mathbf{y}))\ge0$
    and $\alpha(\xi'(\mathbf{y}')\xi'(\mathbf{y})\xi(\mathbf{x}))\ge0$,
    where $\alpha$ is the signed area of the oriented triangle.
\end{lemma}

\begin{lemma}\label{lemma:edgver}
    Let $K$ and $K'$ be two polygons that intersect at a point and not at a segment.
    The intersection point $\mathbf y$ is a vertex of one polygon, which we let be $K'$,
    and sits in the relative interior of an edge $\mathbf{x}'\mathbf{x}$ of $K$,
    oriented counter clockwise from the point of view of the interior of $K$.
    There is some $\epsilon>0$ such that whenever $||\xi||,||\xi'||<\epsilon$,
    then $\xi(K)$ and $\xi'(K')$ have disjoint interiors if and only if
    $\alpha(\xi(\mathbf{x})\xi(\mathbf{x}')\xi'(\mathbf{y}))\ge0$.
\end{lemma}

Note that the case of an intersection at a point that is a vertex of both polygons
is not treated. In the first two cases we treat, the regular pentagon
and the regular heptagon, there are no such intersections. When we generalize
the calculation to all convex polygons, we will show that such an intersection
only occurs in special cases that can be treated separately.

%\begin{lemma}
%    Let $K$ be a convex polygon and let $\theta$ be such that $A(\theta)$
%    is minimal, then there is a half-length parallelogram in the
%    direction $\theta$ that shares no vertex with $K$ and an affine
%    diameter with no more than one vertex shared with $K$.
%\end{lemma}

\subsection{other theorems}

We will show that optimization problems we obtain fall into a convenient
form, where linear stability holds along all but one direction. Along
the direction of vanishing linear stability, the construction of
Kuperberg and Kuperberg will be shown to guaranty stability.

\begin{theorem}
Programs satisfying conditions (*) have a local maximum at 0.
\end{theorem}

\section{Calculation}

\subsection{Pentagons}

Let us fix a regular pentagon $K=\mathrm{conv} \{\mathbf{k}_i:i=0,\ldots 4\}$, where $\mathbf{k}_i = R_{2\pi i/5} (1,0)$.
In this subsection, we do all the calculations in the extension field $\mathbb{Q}(u,v)$, where $u=\cos \pi/5$ and $v=\sin \pi/5$.

One minimum-area half-length parallelogram corresponds to the affine diameter $\mathbf{p}_1\mathbf{p}_4$, where
$\mathbf{p}_1 = \mathbf{k}_0$ and $\mathbf{p}_4 = \tfrac12 (\mathbf{k}_2+\mathbf{k}_3)$.
The vertices of the parallelogram are given by
$\mathbf{p}_2=\tfrac14\mathbf k_0+\tfrac34\mathbf k_1$,
$\mathbf{p}_3=\tfrac{3-2u}4\mathbf k_1+\tfrac{1+2u}4\mathbf k_2$,
$\mathbf{p}_5=\tfrac{1+2u}4\mathbf k_3+\tfrac{3-2u}4\mathbf k_4$, and
$\mathbf{p}_6=\tfrac34\mathbf k_4+\tfrac14\mathbf k_0$.

The four pentagons that surround our primitive honeycomb cell are
$\xi_i(K)$, $i=0,1,2,6$, where $\xi_0=\mathrm{Id}$,
$\xi_1=T_{\mathbf{p}_1-\mathbf{p}_4}$,
$\xi_2=I_{\mathbf{p}_2}$,
and $\xi_6=I_{\mathbf{p}_6}$.
We are interested in showing that the assignment $\xi_i'=\xi_i$, $i=0,1,2,6$ locally
minimizes the area of the quadrilateral $\xi_0(0)\xi_6(0)\xi_1(0)\xi_2(0)$, subject
to the nonoverlap constraints. As explained in the previous section, we may
fix $\xi_1'=\xi_1$ and replace the nonoverlap constraints by signed area constraints. We
obtain the following optimization problem:

\begin{equation}\label{eq:opt-pent}
    \begin{aligned}
	\text{minimize } & f(z)=\alpha(\xi'_0(0),\xi'_1(0),\xi'_2(0))-\alpha(\xi'_0(0),\xi'_1(0)+\xi'_6(0) )\\
	\text{subj.\ to } & g_1(z)=\alpha(\xi'_0(\mathbf{k}_1),\xi'_0(\mathbf{k}_0),\xi'_2(\mathbf{k}_1))\ge0\\
	                & g_2(z)=\alpha(\xi'_2(\mathbf{k}_1),\xi'_2(\mathbf{k}_0),\xi'_0(\mathbf{k}_1))\ge0\\
	                & g_3(z)=\alpha(\xi'_0(\mathbf{k}_0),\xi'_0(\mathbf{k}_4),\xi'_6(\mathbf{k}_4))\ge0\\
	                & g_4(z)=\alpha(\xi'_6(\mathbf{k}_0),\xi'_6(\mathbf{k}_4),\xi'_0(\mathbf{k}_4))\ge0\\
	                & g_5(z)=\alpha(\xi'_1(\mathbf{k}_2),\xi'_1(\mathbf{k}_1),\xi'_2(\mathbf{k}_2))\ge0\\
	                & g_6(z)=\alpha(\xi'_2(\mathbf{k}_2),\xi'_2(\mathbf{k}_1),\xi'_1(\mathbf{k}_2))\ge0\\
	                & g_7(z)=\alpha(\xi'_1(\mathbf{k}_4),\xi'_1(\mathbf{k}_3),\xi'_6(\mathbf{k}_3))\ge0\\
	                & g_8(z)=\alpha(\xi'_6(\mathbf{k}_4),\xi'_6(\mathbf{k}_3),\xi'_1(\mathbf{k}_3))\ge0\\
	                & g_9(z)=\alpha(\xi'_1(\mathbf{k}_3),\xi'_1(\mathbf{k}_2),\xi'_0(\mathbf{k}_0))\ge0,
    \end{aligned}
\end{equation}
where $\xi'_i=T_{(x_i,y_i)}\xi_iR_\theta$ for $i=0,2,6$, and $\xi'_1=\xi_1$. We adopt
a condensed notation for the free variables $X=(x_0,y_0,\theta_0,x_2,y_2,\theta_2,x_6,y_6,\theta_6)$.

We consider the linearization of \ref{rq:opt-pent} around the point $z=0\in\mathbb{R}^9$. This gives a
problem of the form
\begin{equation}\label{eq:lin-pent}
    \text{minimize } c\cdot z \text{ subject to } G z\ge 0\text,
\end{equation}
where $c\in \mathbb R^9$, $G\in\mathbb{R}^{9\times9}$ and we use the linear programming notation $\ge0$
to denote a vector lying in the closed positive orthant.
We can show by direct calculation a vector $\eta>0$ lying in the open positive orthant exists such that
$c=\eta^T G$. By the fundamental theorem of linear algebra, this observation implies that $G z\ge 0$ and $c\cdot X\le0$
if and only if $G z = 0$ and $c\cdot z=0$. We can show that $\mathrm{rank} G=8$, and so the program
\ref{eq:lin-pent} is minimized exactly by the null space of $G$ and is suboptimal elsewhere in the
cone $Gz\ge0$. The null space corresponds precisely to the rearrangement given by choosing a nearby
half-length parallelogram in the double lattice construction to the minimum-area one. Let $z^{(0)}$
generate the null space, then $t_0^{(0)}=t_2^{(0)}=t_6^{(0)}=0$. We can verify directly
that $f(tz^{(0)})$ is a quadratic function of $t$ minimized at $t=0$, and that
$g_r(tz^{(0)})=0$ identically for $r=1,\ldots,9$. Indeed, perturbing the half-length
parallelogram away from the minimum-area one increases the area of the resulting cell
and maintains all the contacts.

Therefore, \ref{eq:opt-pent} satisfies all the conditions of \ref{}, and we have:

\begin{theorem}
    The optimal double-lattice packing of regular pentagons, illustrated in Figure X, is strongly extreme.
\end{theorem}

\subsection{Heptagons}

The calculation for the regular heptagon starts out the same as the calculation presented above for regular pentagons.
However, it turns out that the linear program equivalent to \ref{eq:lin-pent} is in this case not minimized
at $z=0$, and so we will need to add auxiliary cost functions to the area as allowed for in \ref{thm:aux}.


\subsubsection{ find the construction given by Theorem \ref{thmkk}.}

\subsubsection{parametrize neighborhood of four heptagons in correct configuration}
include figures

\subsubsection{constrained optimization problem}




\subsubsection{the cost functions }

Construct a cost function that satisfies the condition of correction theorems and makes the program satisfy the conditions of the LP theorems.


YOU GET THE COST FUNCTION FROM THE PROGRAM, AND IT SATISFIES THE PROPERTIES OF SECTION 1....

This area could be confusing as the objective functions become fairly complicated.  Need to justify replacing objective functions with modifications.  i.e., 

Sketch: Minimize the area of the Delaunay triangles.  If there is no nearby configuration that decreases area done. (can we increase area and still increase density? possibly locally, so need to trade between nearby double triangles.  But by symmetry, introduce a cost function between the "outer" heptagons, i.e. penalize rotation in opposite directions.)
In general, average area of double triangles is minimized implies average density is maximized.

The function optimized in this case is the (modified) area of the Delaunay triangles. 

%$U$ is the area of the double Delaunay triangle
%
%$$Ux = U + (1/2 + u1^2) V[[3]] - (1/2 + u1^2) V[[4]] + (1/2 + u1^2) V[[
%    8]] - (1/2 + u1^2) V[[9]]$$
    
          
%1) modification given was constructed to satisfy XYZ to give the local optimality and satisfy certain properties
%2) Justify modification via it's properties, not via what the actually modification is.


% \begin{lemma}
% an objective function satisfying properties XYZ has an isolated max at 0 and satisfying properties ABC also maximizes the density function.
% \end{lemma} 
% 
% \begin{proof}
% XYZ follows from theorem.
%
% ABC follows from ...  geometric sketch argument should be replaced by an analysis argument.
%\qed \end{proof}
%
%
%\begin{lemma}
%the construction of 
%\end{lemma}




\subsection{general (2n+1)-gons}
failure in the case of the enneagon, the construction of K+K is problematic.  This requires additional analysis as 

four polygons with corrected area function and an SL(2,R) motion hessian?  The SL2 motion is required for the solution part, i.e. finding the initial configuration for regular polygons.  Check this makes sense.

\section{Formal methods}%Need good documentation for mathematica packages and for the code to be supplied.
%Computations are performed in Mathematica 10.0.1.0
%
%\subsection{interval arithmetic}
%The final certificates for these optimization problems are computations that show some final values is strictly positive.  This can be performed numerically given proper precision and accuracy control with regards to rounding error.  For example, the Wolfram System supports explicit tracking of numerical intervals and error via the use of the$Interval[]$ head.  Then the strict positivity of of the resultant interval guarantees the strict positivity of the final value which is contained in that interval.


\subsection{symbolic computation in an extension field}
The Wolfram System supports symbolic computation over extension fields via its pattern matching system.


%$Simplify[,Assumptions->]$ head and pattern matching




\section{Slicing nonlinear programs}\label{slice}

A non-linear programing problem satisfying certain conditions can be certified as locally optimal by a linear programming problem.  For the geometric problems considered, there are $a$ $priori$ configurations given by the maximal density configurations on a subspace of configuration space, namely subsets of the double lattice packings.  To produce a certificate of local optimality for this type of problem it is possible to parametrize a neighborhood of the conjectured optimal configuration and analyze the associated non-linear programming problem
$$\max_{x\in \mathbb{R}^n} f(x)\textrm{ subject to }g_r(x)\ge 0, r\in I$$
in a neighborhood of $0.$ An appropriate choice of parametrization allows the full non-linear program to be sliced into a one-parameter family of non-linear programs that are subordinate to the linearization of the main program at $0$. The following conditions are required.

\begin{conditions}\label{assumpt}\begin{footnote}{These are the conditions that are required for the packing problems addressed. There are a number of ways they might be weakened, e.g. the condition that $E$ be 1-dimensional is not essential.}\end{footnote}\textrm{ }
\begin{enumerate}
\item \label{a finite} Let $I$ be a finite index set.
\item \label{standard} Let $e_1$ be the standard unit vector $\{1, 0,\dots,0\}$ in $\mathbb{R}^n.$
\item \label{analytic} For $r$ in $I$, let $f$ and $g_r$ be analytic functions on a neighborhood of $0$.
\item \label{azero} Assume $f(0) = g_r(0) = 0$ for all $r$ in $I$.
\item \label{afderiv} Let  $F(t) = \nabla f (te_1)$.
\item \label{agderiv} Let $G_r(t) = \nabla g_r(te_1)$.
\item \label{abounded} Assume the linear program
$$\max_{x\in \mathbb{R}^n}F(0)\cdot x \textrm{ subject to }G_r(0)\cdot x \ge 0, r\in I$$
has a bounded solution and that the maximum is attained at 0.
\item \label{asolutionset} Assume that the set of solutions in $\mathbb{R}^n$ to 
$$F(0)\cdot x = 0\textrm{ subject to }G_r(0)\cdot x \ge 0, r\in I$$
is $$E := \{te_1 : t\in \mathbb{R}\}.$$
\item \label{aortho} Let $H$ be the orthogonal complement of $E$ so that $\mathbb{R}^n = E \oplus H.$ 
\item \label{anbhd} Assume there is an $\epsilon > 0$ so the functions $g_r(te_1) = 0$ for all $t\in (-\epsilon, \epsilon)$, for all $r$ in $I.$
\item \label{ahess} Assume $\frac{\partial f}{\partial t}(0) = 0$, $\frac{\partial^2 f}{\partial t^2}(0) < 0.$
\end{enumerate}
\end{conditions}


%Not sure if this should be changed to multivariable here or if the higher dimensional E cases should be reduced%

%\begin{assumptions}\label{assumpt}
%\begin{enumerate}
%\item Let $I$ be a finite index set.
%\item Let $e_i$ be the $i$-th standard unit vector.
%\item For $r$ in $I$, let $f$ and $g_r$ be analytic functions on a neighborhood of $0$.
%\item Assume $f(0) = g_r(0) = 0$ for all $r$ in $I$.
%\item Let $F_i(t) = \nabla f (t_ie_i)$.
%\item Let $G_{r,i}(t) = \nabla g_r(t_ie_i)$.
%
%\item Let $\mathbf{t} = \{t_1, \dots , t_k\}$
%\item Let $F(\mathbf{t}) = \Sigma F_i(t).$
%\item Let $G_r(\mathbf{t}) = \Sigma G_{i,r}(t).$
%
%\item Assume the linear program
%$$\max_{x\in \mathbb{R}^n}F(0)\cdot x \textrm{ subject to }G_r(0)\cdot x \ge 0, r\in I$$
%has a bounded solution and that the maximum is attained at 0.
%\item Assume that the set of solutions in $\mathbb{R}^n$ to 
%$$F(0)\cdot x = 0\textrm{ subject to }G_r(0)\cdot x \ge 0, r\in I$$
%is $$E:= span\{e_1,\dots,e_k\}$$  %$$E := \{te_1 : t\in \mathbb{R}\}.$$ 
%\item Let $H$ be the orthogonal complement of $E$ so that $\mathbb{R}^n = E \oplus H.$ 
%\item Assume there is an $\epsilon > 0$ so the functions $g_r(te_i) = 0$ for all $t\in (-\epsilon, \epsilon)$, for all $r$ in $I$ and $i$ in ${1,\dots k}.$
%\item Assume that in $E$, $Df = 0$ and $Hf$ is negative definite.   %$\frac{\partial }{\partial t}f(0) = 0$, $\frac{\partial^2 }{\partial t^2}f(0) < 0.$
%\end{enumerate}
%\end{assumptions}

\begin{lemma}\label{lem1} Given Conditions \ref{assumpt}, the linear program 
$$\max_{x\in H }F(0)\cdot x\textrm{ subject to }G_r(0)\cdot x \ge 0, r\in I$$
has a unique maximum at $x = 0$
\end{lemma}
\begin{proof}
By conditions \ref{abounded} and \ref{asolutionset}, the linear program
$$\max_{x\in \mathbb{R}^n}F(0)\cdot x\textrm{ subject to }G_r(0)\cdot x \ge 0, r\in I$$
is maximized exactly on $E$. The feasible set $\{x : G_r(0)\cdot x \ge 0, r\in I \textrm{ and } x \in H\}$ is a subset of the feasible set $\{x:G_r(0)\cdot x \ge 0, r\in I\}$. Thus, the program 
$$\max_{x\in H}F(0)\cdot x\textrm{ subject to }G_r(0)\cdot x \ge 0, r\in I$$
 is maximized exactly on the non-empty intersection $$E\cap \{x :G_r(0)\cdot x\ge 0, r\in I\} \cap H = 0.$$
\end{proof}

\begin{definition}
A \emph{finitely generated cone} is a subset of $\mathbb{R}^n$ which is the non-negative span of a finite set of non-zero vectors $\{v_1,\dots, v_m\}$ in $\mathbb{R}^n$, which are called the \emph{generators} of the cone. 
\end{definition}
\begin{definition}
A \emph{conical linear program} is a linear program with a constraint set that is a finitely generated cone.
\end{definition}

The linear programs described throughout this section are always constrained to be on the intersection of half-spaces with $0$ on the boundary. These are conical programs.

\begin{definition}
For a cone $C$, the set $C^p := \{x \in \mathbb{R}^n: v\cdot x \le 0 \textrm{ for all } v \in C\}$ is the \emph{polar cone} of $C.$
\end{definition}

\begin{lemma}\label{lem2}
A conical linear program with $F\ne 0$ given by
$$\max_{x\in \mathbb{R}^n} F\cdot x\textrm{ subject to }G_r\cdot x \ge 0, r\in I $$ 
(a) has a unique\begin{footnote}{The maximum satisfies a stronger uniqueness condition. It is stable under perturbations of $F$ and $G_k$.}\end{footnote} maximum at $x= 0$ iff $F$ is in the interior of the polar cone $C^p$ of $C= \{x : G_r\cdot x \ge 0, r\in I\}$ (b) has a bounded solution iff $F$ is in the polar cone $C^p$ of  $C =\{x : G_r\cdot x \ge 0, r\in I\}$ and attains its maximum exactly on the span of the generators $v_i$ such that $F\cdot v_i =0.$
\end{lemma}
\begin{proof}
If $F$ is in the interior of the polar cone $C^p$, then $F\cdot v_i < 0$ for all generators $v_i$.  Therefore $F\cdot x$ is uniquely maximized in $C$ at the vertex. If $F$ is on the boundary of the polar cone, then $F\cdot x$ is maximized in $C$ exactly on the span of the generators $v_i$ for which $F\cdot v_i = 0$ as $F\cdot v_j < 0$ otherwise. If $F$ is outside the polar cone, then $F\cdot v_i >0$ for some generator $v_i$. Then $F\cdot x$ is unbounded in $C$.\end{proof}

\begin{lemma}\label{lem3} Given Conditions \ref{assumpt}, there exists $\epsilon > 0$ such that for all $t$ in  $(-\epsilon,\epsilon)$, the linear program 
$$\max_{y_t \in H}F(t)\cdot y_t$$
subject to 
$$G_r(t)\cdot y_t \ge 0, r \in I$$
has a unique maximum at $y_t = 0$.\begin{footnote}{Here $y_t$ is a dummy variable and does not depend on $t$. It is labeled $y_t$ to ease later exposition.}\end{footnote}
\end{lemma}
\begin{proof} The program for $t\in (-\epsilon,\epsilon)$, for $y_t$ in $H$, for each fixed $t$ in $(-\epsilon,\epsilon)$, for some $\epsilon> 0$, can be written as a conical program on all of $\mathbb{R}^n$ with a cone $C_t$ in $\mathbb{R}^n$ of co-dimension $\ge 1$ by introducing further constraints $e_1\cdot y_t \ge 0$ and $-e_1\cdot y_t \ge 0.$  By Lemmas \ref{lem1} and \ref{lem2}, $F(0)$ is in the polar cone of $C_0 = \{y_0: G_r(0)\cdot y_0 \ge 0, e_1\cdot y_0 \ge 0, -e_1\cdot y_0 \ge 0\}.$   As $f,g_r \in C^\omega$, the condition of  $F(t)$ being in the interior of the polar cone $C_t^p$ is open and the condition of the feasible set $C_t = \{y_t: G_r(t)\cdot y_t \ge 0, e_1\cdot y_t \ge 0, -e_1\cdot y_t \ge 0\}$ being conical is open.\begin{footnote}{The relationships between the constraint cone, the generators $v_i$ and the constraint gradients $G_k$ are nontrivial as $t$ varies, but the openness of this condition follows from the continuity of the distance function.}\end{footnote}  Therefore, by Lemma \ref{lem2} the program has a unique maximum at $y_t = 0$ for each fixed $t$ in $(-\epsilon,\epsilon)$ for some $\epsilon> 0$.\end{proof}

\begin{lemma}\label{lem4}
Given Conditions \ref{assumpt} and $\epsilon$ as in Lemma \ref{lem3}, for all $t \in (-\epsilon, \epsilon)$
there exists $\delta(t)>0$ and a cube $Q(t) \subset \mathbb{R}^n$ of side length $2\delta(t)$ such that 
$$\{(F(t) + Q(t)) \cap (\partial (C_t^p) + Q(t))\} = \emptyset.$$
\end{lemma}
\begin{proof}
This follows from Lemma \ref{lem3}, which shows $F(t)$ is in the interior of the polar cone $C_t^p$.  Then $F(t)$ and the boundary of $C_t^p$ can be separated and the existence of $Q$ is trivial.
\end{proof}

\begin{corollary}\label{cor1}
Given Conditions \ref{assumpt} and $\epsilon$ as in Lemma \ref{lem3}, for all $t \in (-\epsilon, \epsilon),$ 

$$(F(t)+\Delta) \cdot y_t \le 0$$
whenever $y_t$ satisfies
$$(G_r(t)+\Delta_r)\cdot y_t \ge 0, r\in I
\textrm{ and } 
e_1\cdot y_t \ge 0, -e_1\cdot y_t \ge 0$$
 where $\Delta$ and $\Delta_r$ are any points in the $2\delta(t)$-cube $Q(t)$ and $y_t$ is in $H$.
\end{corollary}
\begin{proof}
By Lemma \ref{lem4}, $F(t)+\Delta$ is in the interior of the polar cone $C_{t,\Delta}^p$, where $C_{t,\Delta} = \{y_t: (G_r(t)+\Delta_r)\cdot y_t \ge 0, e_1\cdot y_t \ge 0, -e_1\cdot y_t \ge 0, r\in I\}$.  
\end{proof}

\begin{lemma}\label{lem5}
Given Conditions \ref{assumpt} and $\epsilon$ as in Lemma \ref{lem3}, for all $t \in (-\epsilon, \epsilon)$, let $y_t = x-te_1 \in H$. Choose $\Delta = \Delta(y_t)$ and $\Delta_r=\Delta_r(y_t)$ in the $2\delta(t)$-cube $Q(t)$ to be the corner given by the sign of $x-te_1 = y_t.$ Then there is an $\epsilon_t$ for which 

$$(F(t)+\Delta(y_t))\cdot y_t \le 0 \implies f(x)-f(te_1) \le 0$$
and
$$(G_r(t)+\Delta_r(y_t))\cdot y_t \le 0 \implies g_r(x)-g_r(te_1) = g_r(x)\le 0$$

for all $\|y_t\| \le \epsilon_t$.
\end{lemma}
\begin{proof}
This follows from the local expansions of the nonlinear program.  By this choice of $\Delta(y_t)$ and $\Delta_r(y_t),$

$$f(x)-f(te_1)  = F(t)\cdot (x-te_1) + O(t^2) = F(t)\cdot y_t + O(t^2) $$
$$ \le  F(t)\cdot y_t + \delta(t) \|y_t\|_1 = (F(t)+\Delta(y_t))\cdot y_t $$
and using condition \ref{anbhd},
$$g_r(x) = g_r(x)-g_r(te_1) =  G_r(t)\cdot (x-te_1) + O(t^2) = G_r(t)\cdot y_t +O(t^2) $$
$$ \le  G_r(t)\cdot y_t + \delta(t) \|y_t\|_1 = (G_r(t)+\Delta_r(y_t))\cdot y_t.$$
\end{proof}

By Lemma \ref{lem4} and Corollary \ref{cor1}, for $t$ in $(-\epsilon,\epsilon)$, the program  $$\max_{y_t \in H} (F(t) + \Delta)\cdot y_t\textrm{ subject to } (G_r + \Delta_r)\cdot y_t$$ is uniquely maximized at $y_t=0$ for any choice of $\Delta$, $\Delta_r$ in the $2\delta(t)$ cube $Q(t)$. Combined with Lemma \ref{lem5}, there is an $\epsilon_t$ neighborhood of $0$ where $f(y_t+te_1)$ is less than $f(te_1)$ on $\cup_{\Delta_r \in Q(t)}\{y_t: (G_r+\Delta_r) \cdot y_t \ge 0, r \in I, y_t \in H\}$, which contains the feasible set  $\{y_t: g_r(y_t+te_1) \ge 0, r\in I, y_t \in H\}$. Therefore the nonlinear programs $f(y_t+te_1)$ subject to $g_r(y_t+te_1)\ge 0$, $y_t \in H$, which are parameterized by $t$ in $(-\epsilon, \epsilon)$, have local maxima at $y_t=0$.  This gives the following:

\begin{theorem}\label{th1}
Given Conditions \ref{assumpt}, a fixed $t$ in $(-\epsilon, \epsilon)$ and choosing $\Delta$ and $\Delta_r$ as in Lemma \ref{lem5}, for $x$ satisfying $g_r(x)\ge 0$ for all $r$ in $I$ and $y_t = x-te_1$ in $H$, 
there exist linear programs\begin{footnote}{These programs may depend on a choice of $y_t \in H$, but $f(x)$ is always less then $f(te_1)$ by Lemma \ref{lem5}.}\end{footnote} $$\max_{y_t \in H}(F(t)+\Delta(y_t))\cdot y_t \textrm{ subject to }  (G_r(t)+\Delta_r(y_t))\cdot y_t \ge 0$$
that give solutions to the nonlinear programs $$\max_{x \in H+te_1} f(x)  \textrm{ subject to }   g_r(x)\ge 0$$
in an $\epsilon_t$ neighborhood of $te_1$ in $H+te_1.$ \qed
\end{theorem}

By choice of a sufficiently small $\epsilon$ and a minimal\begin{footnote}{This exists by a compactness argument.}\end{footnote} non-zero $\epsilon_t$, Theorem \ref{th1} gives an open neighborhood of $0$ in which the maximum value of the original nonlinear program occurs on $E$. The conditions for the first and second $t$-derivatives at $0$ shows $0$ to be a local maximum for the nonlinear program
 $$\max_{x\in\mathbb{R}^n}f(x) \textrm{ subject to }  g_r(x) \ge 0.$$

\begin{theorem}
A nonlinear program satisfying Conditions \ref{assumpt} has an isolated local maximum at 0 with f(0) = 0. \qed
\end{theorem}

\bibliography{ngon}
\end{document}  
